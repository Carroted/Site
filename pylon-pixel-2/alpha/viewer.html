<!DOCTYPE html>
<html lang="en">

<script>

    var questions = [
        {
            "title": "What's your name?",
            "description": "Using the same name as your Discord username helps.",
            "placeholder": "Name",
            "type": "text",
            "required": true
        },
        {
            "title": "How was the latest build of Pylon Pixel 2 Alpha?",
            "description": "Please rate the build on a scale of 1-10.",
            "placeholder": "1-10",
            "type": "number",
            "required": true
        },
        {
            "title": "What bugs did you encouter?",
            "description": "If you didn't encounter any bugs, leave this blank",
            "placeholder": "Bugs encountered (leave blank for none)",
            "type": "text",
            "required": false
        },
        {
            "title": "Do you have any suggestions for the next build or future?",
            "description": "If you don't have any, leave this blank.",
            "placeholder": "Suggestions (leave blank for none)",
            "type": "text",
            "required": false
        },
        {
            "title": "If you've played a previous build, would you consider this an improvement?",
            "description": "If you haven't played a previous build, leave this blank.",
            "placeholder": "Is this build better? (leave blank if you haven't played a previous build)",
            "type": "text",
            "required": false
        },
        {
            "title": "What do you think of the controls?",
            "description": "Do you think the controls are intuitive and easy to use? Do they look good? Are they confortable? Add any other comments on them here.",
            "placeholder": "Your thoughts on the controls",
            "type": "text",
            "required": true
        },
        {
            "title": "Do you have any other comments?",
            "description": "Anything else you want to add? It could be about the game, the graphics, the controls, or anything else, even this form. If you don't have any, leave this blank.",
            "placeholder": "Comments (leave blank for none)",
            "type": "text",
            "required": false
        },

    ];



</script>


<!-- Meta tags for SEO and social sharing -->
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta name="robots" content="all" />


<link rel="canonical" href="https://carroted.glitch.me/pylon-pixel-2/alpha/feedback.html" />
<meta name="description" content="For PP2AP members" />
<meta property="og:title" content="Pylon Pixel 2 Alpha Program Feedback" />
<meta property="og:url" content="https://carroted.glitch.me/pylon-pixel-2/alpha/feedback.html" />
<meta property="og:description" content="For PP2AP members" />

<meta property="og:image"
    content="/media/Carroted Icon.png" />
<meta name="theme-color" content="#ff7e2c">


<head>
    <link rel="icon"
        href="/media/icon.svg">
    <title>Pylon Pixel 2 Alpha Program Feedback</title>
    <script src="/jquery-3.6.0.min.js" crossorigin="anonymous"></script>
    <link rel="stylesheet" href="/style.css">
</head>
<style>
    .formBox {
        margin-left: 25%;
        margin-right: 25%;
        margin-top: 50px;
    }

    @media screen and (max-width: 700px) {
        .formBox {
            margin-left: 10%;
            margin-right: 10%;
        }
    }

    body {
        padding: 0px;
        margin: 0px;
    }

    :root {
        padding: 0px;
    }

    @media only screen and (min-width: 760px) {

        .drag-area {
            width: 700px;

        }
    }



    /* credit to codingnepal for the file upload box */
    .drag-area {
        border: 2px dashed #b2b8d6;
        height: 250px;
        width: 100%;
        border-radius: 5px;
        display: flex;
        align-items: center;
        justify-content: center;
        flex-direction: column;
    }

    #questionCardElement{
        margin-top : 0px;
    }

    .drag-area.active {
        border: 2px solid #b2b8d6;
    }

    .drag-area .icon {
        font-size: 100px;
        color: #b2b8d6;
    }

    .drag-area header {
        font-size: 30px;
        font-weight: 500;
        color: #b2b8d6;
        text-align: center;
    }

    .drag-area span {
        font-size: 25px;
        font-weight: 500;
        color: #b2b8d6;
        margin: 10px 0 15px 0;
        text-align: center;
    }

    .drag-area img {
        height: 100%;
        width: 100%;
        object-fit: cover;
        border-radius: 5px;
    }
</style>

<body>

    <div id="header"></div>
    <div id="footer"></div>
  <div>
      <br><br><br><br>
  </div>
    <script>
        $(function () {
            $("#header").load("/header.html");
            $("#footer").load("/footer.html");
        });
    </script>

    <br><br>


    <div class="formBox">
        <div class="card" style="margin-bottom:20px;">

        

        <span style="font-size: 24px; margin-bottom:10px; display:inline-block" id="title">Pylon Pixel 2 Alpha Program
            Feedback Viewer</span>
        <span style="font-size: 20px; color:#b2b8d690;"><br><span id="description">Upload files and view answer
                comparison</span></span><br><br>
        <!-- credit to codingnepal for the file upload box -->
        <div id="drag-container">
            <div class="drag-area">
                <svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="54px"
                    viewBox="0 0 24 24" width="54px" fill="#b2b8d6">
                    <g>
                        <rect fill="none" height="24" width="24" />
                    </g>
                    <g>
                        <path
                            d="M19.41,7.41l-4.83-4.83C14.21,2.21,13.7,2,13.17,2H6C4.9,2,4.01,2.9,4.01,4L4,20c0,1.1,0.89,2,1.99,2H18c1.1,0,2-0.9,2-2 V8.83C20,8.3,19.79,7.79,19.41,7.41z M14.8,15H13v3c0,0.55-0.45,1-1,1s-1-0.45-1-1v-3H9.21c-0.45,0-0.67-0.54-0.35-0.85l2.8-2.79 c0.2-0.19,0.51-0.19,0.71,0l2.79,2.79C15.46,14.46,15.24,15,14.8,15z M14,9c-0.55,0-1-0.45-1-1V3.5L18.5,9H14z" />
                    </g>
                </svg>
                <header>Drag & Drop to Upload Answers Files</header>
                <span>OR</span>
                <button class="button button">Browse Files</button>
                <input type="file" hidden>
            </div>
            
        </div>

    </div>

        <div class="card" id="questionCardElement">

        </div>


    </div>

    <script>

        function copyToClipboard(str) {
            const el = document.createElement('textarea');
            el.value = str;
            el.setAttribute('readonly', '');
            el.style.position = 'absolute';
            el.style.left = '-9999px';
            document.body.appendChild(el);
            el.select();
            document.execCommand('copy');
            document.body.removeChild(el);
        };






        let dragfiles;

        // credit to codingnepal for the file upload box

        //selecting all required elements
        const dropArea = document.querySelector(".drag-area"),
            dragText = dropArea.querySelector("header"),
            dragbutton = dropArea.querySelector("button"),
            draginput = dropArea.querySelector("input");


        dragbutton.onclick = () => {
            draginput.click(); //if user click on the button then the input also clicked
        }

        draginput.addEventListener("change", function () {
            //getting user select file and [0] this means if user select multiple files then we'll select only the first one
            dragfiles = this.files;
            dropArea.classList.add("active");
            showFile(); //calling function
        });


        //If user Drag File Over DropArea
        dropArea.addEventListener("dragover", (event) => {
            event.preventDefault(); //preventing from default behaviour
            dropArea.classList.add("active");
            dragText.textContent = "Drop to Upload Answers Files";
        });

        //If user leave dragged File from DropArea
        dropArea.addEventListener("dragleave", () => {
            dropArea.classList.remove("active");
            dragText.textContent = "Drag & Drop to Upload Answers Files";
        });

        //If user drop File on DropArea
        dropArea.addEventListener("drop", (event) => {
            event.preventDefault(); //preventing from default behaviour
            //getting user select file and [0] this means if user select multiple files then we'll select only the first one
            dragfiles = event.dataTransfer.files;
            showFile(); //calling function
        });

        questions.forEach(function (question, i) {

            var questionItem = `<span id="questionNumber">${i + 1}.</span><br><span style="font-size: 24px; margin-bottom:10px; display:inline-block" id="title">${question.title}</span><br><span id="question${i}"></span>`;
            $("#questionCardElement").append(questionItem);

        });

        function showFile() {

            Array.from(dragfiles).forEach(dragfile => {

                let fileType = dragfile.type; //getting selected file type
                let validExtensions = ["application/json"]; //adding some valid image extensions in array
                if (validExtensions.includes(fileType)) { //if user selected file is an image file
                    var reader = new FileReader();
                    reader.onload = processFile(dragfile);
                    reader.readAsText(dragfile);
                } else {
                    alert("Non-JSON file uploaded! Please be sure to only upload answer .json files.");

                    ;
                }

            });

            dropArea.classList.remove("active");
            dragText.textContent = "Drag & Drop to Upload Answers Files"

        }



        var responseLocations;

        function rand(min, max) {
            return parseInt(Math.random() * (max - min + 1), 10) + min;
        }

        function get_random_color() {
            var h = rand(1, 360); // color hue between 1 and 360
            var s = rand(50, 70); // saturation 30-100%
            var l = 48; // lightness 30-70%
            return 'hsl(' + h + ',' + s + '%,' + l + '%)';
        }

        function set_random_color_alpha(color, alpha) {
            var rgb = hslToRgb(color);
            return 'rgba(' + rgb.r + ',' + rgb.g + ',' + rgb.b + ',' + alpha + '%)';
        }

        function hexToRgb(hex) {
            var result = /^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(hex);
            return result ? {
                r: parseInt(result[1], 16),
                g: parseInt(result[2], 16),
                b: parseInt(result[3], 16)
            } : null;
        }

        function hslToRgb(hsl) {
            var parts = hsl.split(',');
            var h = parseInt(parts[0].substr(4), 10) / 360;
            var s = parseInt(parts[1].substr(0, parts[1].length - 1), 10) / 100;
            var l = parseInt(parts[2].substr(0, parts[2].length - 1), 10) / 100;
            var r, g, b;
            if (s == 0) {
                r = g = b = l; // achromatic
            } else {
                function hue2rgb(p, q, t) {
                    if (t < 0) t += 1;
                    if (t > 1) t -= 1;
                    if (t < 1 / 6) return p + (q - p) * 6 * t;
                    if (t < 1 / 2) return q;
                    if (t < 2 / 3) return p + (q - p) * (2 / 3 - t) * 6;
                    return p;
                }

                var q = l < 0.5 ? l * (1 + s) : l + s - l * s;
                var p = 2 * l - q;
                r = hue2rgb(p, q, h + 1 / 3);
                g = hue2rgb(p, q, h);
                b = hue2rgb(p, q, h - 1 / 3);
            }
            return {
                r: Math.round(r * 255),
                g: Math.round(g * 255),
                b: Math.round(b * 255)
            };
        }


        function processFile(file) {
            return function (e) {
                var info = e.target.result;




                var json = JSON.parse(info);

                var color = get_random_color();

                var theGoodEnding = json["0"].replaceAll('<', '(').replaceAll('>', ")").trim(); // bad ending = unsanitized html. big sad, scripts could do bad. good ending = sanitized html. no sad. very happy.



                questions.forEach(function (question, i) {

                    if (!json[i.toString()]) {
                        $("#question" + i).append(`<span style="color:#ff0000"><b>${theGoodEnding} | BE CAREFUL! ${theGoodEnding.toUpperCase()} HAD A NULL OR UNDEFINED ANSWER!</span></b><br><br>`);
                    }
                    else {
                        if (json[i.toString()] != "None") {
                            var goodEnding2 = json[i.toString()].replaceAll('<', '(').replaceAll('>', ")").trim();
                            $("#question" + i).append(`<span style="color:${color}">${theGoodEnding}: <code>${goodEnding2}</code></span><br><br>`);
                        }
                        else {
                            $("#question" + i).append(`<span style="color:${set_random_color_alpha(color, 25)}">${theGoodEnding} (empty)</span><br><br>`);
                        }
                    }



                })


            }
        }


    </script>
    <br><br>


</body>

</html>