<!DOCTYPE html>
<html lang="en">

<script>
    var articlesCount = 6;
    var version = "1.1.3";

    async function fetchAsync(url) {
        let response = await fetch(url);
        let responseText = await response.text();
        return responseText.substring(1);
    }

    var articleFetcher = 'https://seed-alike-meteorite.glitch.me/article/';


</script>

<style>
    * {
        box-sizing: border-box;
    }

    /* Add a gray background color with some padding */
    body {
        padding: 0px;
        padding-top: 20px;

    }
  
  .searchStuffContainment{
    position:relative;
    margin-bottom:5px;
  }

    /* Header/Blog Title */
    .header {
        padding: 5px;
        font-size: 25px;
        text-align: center;
        background-color: #07080e;
        border-radius: 10px;
        box-shadow: 0px 5px 8px #00000050;
        border: #05060a solid 2px;
    }

    /* Create two unequal columns that floats next to each other */
    /* Left column */
    .leftcolumn {
        float: left;
        width: 75%;
    }

    /* Right column */
    .rightcolumn {
        float: left;
        width: 25%;
        padding-left: 20px;
    }

    /* Thumbnail image */
    .thumbimg {
        position: relative;
        overflow: hidden;
        background-color: #000000;
        width: 100%;
        padding: 0;
        margin-bottom: 20px;
        height: 200px;
        border: #04050a solid 2px;
    }



    /* Clear floats after the columns */
    .row:after {
        content: "";
        display: table;
        clear: both;
    }

    /* Footer */
    .footer {
        padding: 10px;
        text-align: center;
        background: #10121a;
        margin-top: 20px;
    }

    .dividerWideOnly {
        display: inherit;
    }

    .dividerNotWideOnly {
        display: none;
    }

    /* Responsive layout - when the screen is less than 1000px wide, make the two columns stack on top of each other instead of next to each other */
    @media screen and (max-width: 1000px) {

        .leftcolumn,
        .rightcolumn {
            width: 100%;
            padding: 0;
        }
    }

    /* Responsive layout - when the screen is less than 500px wide, the top info text gets a line break */
    @media screen and (max-width: 500px) {

        .dividerWideOnly {
            display: none;
        }

        .dividerNotWideOnly {
            display: inherit;
        }
    }


    .author {
        text-decoration: inherit;
    }

    .author:hover {

        text-decoration: inherit;

    }

    

    .inputfield {
        background-color: #2c3042;
        /* Green */
        border: none;
        color: white;

        padding: 4px 9px;
     
        text-decoration: none;
      display:block;
        font-family: Lexend;
        font-size: 14px;
    }


   </style>


<!-- Meta tags for SEO and social sharing -->
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta name="robots" content="all" />
<meta name="keywords" content="carroted,article,blog,post,news">

<meta name="description"
    content="The Carroted Blog is a place where news, updates and announcements about Carroted or Carroted projects will be posted." />
<meta property="og:title" content="Carroted | Blog" />
<meta property="og:description"
    content="The Carroted Blog is a place where news, updates and announcements about Carroted or Carroted projects will be posted." />
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />

<meta property="og:image"
    content="/media/Carroted Icon.png" />
<meta name="theme-color" content="#ff7e2c">


<head>
    <link rel="icon"
        href="/media/icon.svg">
    <script src="/jquery-3.6.0.min.js" crossorigin="anonymous"></script>
    <link rel="stylesheet" href="/style.css">
    <title>Carroted | Blog</title>
</head>

  <style>
   .search {
        width: 50px;
        right: 0px;
        position: absolute;
        height: 25px;
        transform: translate(0px, 0.5px);
        margin: 0px;
      border-top-left-radius:0px;
      border-bottom-left-radius:0px;

    }
    
    .inputfield {
        
        position: absolute;
        left: 0px;
        right:52px;
        margin: 0px;
      
      border-top-right-radius:0px;
      border-bottom-right-radius:0px;

    }
</style>

<body>

    <div id="header"></div>
    <div id="footer"></div>
  <div>
      <br><br><br><br>
  </div>
    <script>
        $(function () {
            $("#header").load("/header.html");
            $("#footer").load("/footer.html");
        });
    </script>



    <div class="header">
        <h2 id="headerText" style="margin-bottom: 8px">Blog | Home</h2>
        <span style="font-size:15px;" id="headerInfo">Loading...</span>
    </div>

    <div class="row">
        <div class="leftcolumn" id="articlesContainer">
            <div class="card">
                Loading...
            </div>
        </div>
        <div class="rightcolumn">
            <div class="card">
              
                <h2 style="vertical-align:middle; display: inline-flex; align-items: center;"><svg xmlns="http://www.w3.org/2000/svg" height="34px" viewBox="0 0 24 24" width="34px"
                        fill="#adb6d6">
                        <path d="M0 0h24v24H0V0z" fill="none" />
                        <path
                            d="M15.5 14h-.79l-.28-.27c1.2-1.4 1.82-3.31 1.48-5.34-.47-2.78-2.79-5-5.59-5.34-4.23-.52-7.79 3.04-7.27 7.27.34 2.8 2.56 5.12 5.34 5.59 2.03.34 3.94-.28 5.34-1.48l.27.28v.79l4.25 4.25c.41.41 1.08.41 1.49 0 .41-.41.41-1.08 0-1.49L15.5 14zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z" />
                    </svg>
                    &nbspSearch</h2><br>
                Search the blog for specific content<br><br>
              <div class="searchStuffContainment">
                
              
                <input class="inputfield" type="text" id="searchBar" placeholder="Search"
                    onkeydown="if (event.keyCode == 13) { search(); return false; }" />
                <button class="button search"
                    style="display:inline-flex; align-items:center; padding:0; padding-top:3px; text-align:center; display: inline-block"
                    onclick="search();">

                    <svg xmlns="http://www.w3.org/2000/svg" height="20px" viewBox="0 0 24 24" width="20px"
                        fill="#FFFFFF">
                        <path d="M0 0h24v24H0V0z" fill="none" />
                        <path
                            d="M15.5 14h-.79l-.28-.27c1.2-1.4 1.82-3.31 1.48-5.34-.47-2.78-2.79-5-5.59-5.34-4.23-.52-7.79 3.04-7.27 7.27.34 2.8 2.56 5.12 5.34 5.59 2.03.34 3.94-.28 5.34-1.48l.27.28v.79l4.25 4.25c.41.41 1.08.41 1.49 0 .41-.41.41-1.08 0-1.49L15.5 14zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z" />
                    </svg>

                </button></div><br>
            </div>
            <div class="card">
                <h2>About</h2>
                <p>The Carroted Blog is a place where news, updates and announcements about Carroted or Carroted
                    projects will be
                    posted.</p>
                <p>There is no fixed schedule of when articles will be written and/or published.</p>
                <p>The Carroted Blog was started in 2022, and was developed by <a href="https://github.com/Alex-Sour"
                        target="_blank" class="author">Alex_Sour</a>.</p>
                <span id="versionP"></span>
            </div>


        </div>

    </div>

    <!--  <div class="footer">
        Page 1 of 1
    </div>-->

    <script>


        function addArticle(articleID, articleTitle, articleAuthorPage, articleAuthorAvatar, articleAuthorName, articleDate, articleThumbnail, articleDescription) {
            var card = `<div class="card">
    <a href="javascript:switchToArticle(${articleID});" class="author"><h2>${articleTitle}</h2></a>
    <h5>
        <a class="author" href="${articleAuthorPage}">
            <img src="${articleAuthorAvatar}" alt="${articleAuthorName}'s profile picture"
            style="height:22px; border-radius: 50%; vertical-align: middle; border: #04050a solid 2px;">
            ${articleAuthorName}</a>&nbsp&nbsp|&nbsp&nbsp${articleDate}
    </h5>
    <div class="thumbimg"><img style="display: block; width: 100%; position: absolute; top: 50%; transform: translateY(-50%);" alt="Article Thumbnail Image" src="${articleThumbnail}" /></div>
    ${articleDescription}<br><br><a href="javascript:switchToArticle(${articleID});">Read more</a>
</div>`;

            $("#articlesContainer").append(card);
        }

        function addArticleFull(articleID, articleTitle, articleAuthorPage, articleAuthorAvatar, articleAuthorName, articleDate, articleThumbnail, articleDescription, articleContent) {
            var card = `<div class="card">
    <h2>${articleTitle}</h2>
    <h5>
        <a class="author" href="${articleAuthorPage}">
            <img src="${articleAuthorAvatar}" alt="${articleAuthorName}'s profile picture"
            style="height:22px; border-radius: 50%; vertical-align: middle;">
            ${articleAuthorName}</a>&nbsp&nbsp|&nbsp&nbsp${articleDate}<span id="viewsArticle"></span>
    </h5>
    <div class="thumbimg"><img style="display: block; width: 100%; position: absolute; top: 50%; transform: translateY(-50%);" alt="Article Thumbnail Image" src="${articleThumbnail}" /></div>
    ${articleDescription}<br><br><hr class="solid"><br>${articleContent}<br><br><hr class="solid"><br>${articleDate}
</div>`;

            $("#articlesContainer").append(card);

            // Change #headerText's text to the article's name
            $("#headerText").text(articleTitle);

            //fetchAsync(articleFetcher + articleID.toString().trim()).then(views => { $("#viewsArticle").html(`&nbsp&nbsp|&nbsp&nbsp${views} views`) });

        }

        getTxt = function () {

            $.ajax({
                url: 'text.txt',
                success: function (data) {
                    //parse your data here
                    //you can split into lines using data.split('\n') 
                    //an use regex functions to effectively parse it
                }
            });
        }

        // Change the #headerInfo innerHTML
        function setHeaderInfo(newInnerHTML) {
            $("#headerInfo").html(newInnerHTML);
        }

        setHeaderInfo(`Carroted Blog v${version}
        
        <span class="dividerWideOnly"> | </span>
        
        <span class="dividerNotWideOnly">
            <br>
        </span>
        
        Developed by <a href="https://github.com/Alex-Sour" target="_blank" class="author">Alex_Sour</a>
        
       
        <br><br>`);

        $("#versionP").html(`It is currently on version ${version}.`);

        function dateToString(date) {
            var strArray = ['January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October', 'November', 'December'];
            var d = date.getDate();
            var m = strArray[date.getMonth()];
            var y = date.getFullYear();

            // Get the time in hours and minutes. If the user lives in a place with a 24-hour clock, show the time in 24-hour format. Otherwise, show the time in 12-hour format.
             var date2 = new Date(Date.UTC(2012, 11, 12, 3, 0, 0));
            var dateString = date2.toLocaleTimeString();


            var format24 = false;
          
            if (dateString.match(/am|pm/i) || date2.toString().match(/am|pm/i)) {
                //12 hour clock
                format24 = false;
            }
            else {
                //24 hour clock
                format24 = true;
            }

            var minutes = date.getMinutes();
            // If the minutes are less than 10, add a 0 in front of the minutes.
            if (minutes < 10) {
                minutes = "0" + minutes;
            }

            var time24 = date.getHours() + ":" + minutes;
            var time12 = (date.getHours() % 12 || 12) + ":" + minutes + " " + (date.getHours() < 12 ? "AM" : "PM");

            var shownTime = format24 ? time24 : time12;


            return '' + m + ' ' + d + ', ' + y + ', ' + shownTime;
        }

        function getArticleWriter(writerName) {
            /* /blog/writers.json contains content like this:
            {
  "alexsour":{
    "displayName":"Alex_Sour",
    "page":"/alexsour",
    "avatar":"https://cdn.glitch.global/d8a67d05-9666-4c27-b92c-98fd552701fd/Spinny%20Alex.gif?v=1646579309555"
  }
}
*/
            // Return the writer object for the given writer name
            var writer = null;
            $.ajax({
                url: '/blog/writers.json',
                async: false,
                success: function (data) {
                    writer = data[writerName];
                }
            });

            if (writer == null) {
                writer = {
                    "displayName": "Unknown",
                    "page": "/404.html",
                    "avatar": "https://cdn.glitch.com/d8a67d05-9666-4c27-b92c-98fd552701fd%2Fcarroted%20circle.png?v=1628802295961"
                }
            }

            return writer;

        }

        async function ajaxFor(i) {
            console.log(i);
            var currentI = i;
            await $.ajax({
                url: '/blog/articles/' + (currentI - 1) + ".json",
                type: 'GET',
                success: function (data) {
                    var article = data;
                    var writer = getArticleWriter(article.author);



                    addArticle(currentI - 1, article.title, writer.page, writer.avatar, writer.displayName, dateToString(new Date(article.date * 1000)), article.thumbnail, article.description);
                },
                timeout: 10000,
            }).catch(error => { console.log(error); });
        }
        async function doAjaxFor() {
            var loading = `<div class="card" id="fetchLoading">
    Loading...
</div>`;

            $("#articlesContainer").append(loading);

            for (var i = articlesCount; i > 0; i--) {
                await ajaxFor(i);
                $("#fetchLoading").insertAfter($("#articlesContainer").children().last());
            }

            // Remove the loading card
            $("#fetchLoading").remove();

            // Set headerText text to "Blog | Home"
            $("#headerText").text("Blog | Home");
        }


        function ajaxCurrentI(currentI) {
            return $.ajax({
                url: '/blog/articles/' + (currentI - 1) + ".json",
                type: 'GET',
            });
        };
        var articlesListCard = `<div class="card" id="articlesListCard">
                <h2>Articles List</h2>
               Click an article's title or "Read more" link to read it.
            </div>`;
        async function ajaxForSearch(i, searchQuery) {
            var currentI = i;

            var res = await ajaxCurrentI(currentI);

            var article = res;
            var writer = getArticleWriter(article.author);

            // If the article contains the search query, add it to the page
            if (article.title.toLowerCase().includes(searchQuery) || article.description.toLowerCase().includes(searchQuery) || writer.displayName.toLowerCase().includes(searchQuery) || dateToString(new Date(article.date * 1000)).toLowerCase().includes(searchQuery)) {
                addArticle(currentI - 1, article.title, writer.page, writer.avatar, writer.displayName, dateToString(new Date(article.date * 1000)), article.thumbnail, article.description);
                return true;
            }
            else {
                return false;
            }
        }
        var doingSearch = false;
        var backToArticles = `<div class="card"><a href="javascript:switchToArticlesList()" class="svglink" style="display:inline-flex; align-items:center;vertical-align:middle; text-decoration:inherit;">
                    
                    <svg xmlns="http://www.w3.org/2000/svg" height="20px" viewBox="0 0 24 24" width="20px"><path d="M0 0h24v24H0V0z" fill="none"/><path d="M19 11H7.83l4.88-4.88c.39-.39.39-1.03 0-1.42-.39-.39-1.02-.39-1.41 0l-6.59 6.59c-.39.39-.39 1.02 0 1.41l6.59 6.59c.39.39 1.02.39 1.41 0 .39-.39.39-1.02 0-1.41L7.83 13H19c.55 0 1-.45 1-1s-.45-1-1-1z"/></svg>
                    
                    &nbspBack to Articles List</a></div>`;
        async function doAjaxForSearch(searchQuery) {
            doingSearch = true;
            var loading = `<div class="card" id="searchLoading">
    Searching...
</div>`;

            var loadedArticles = 0;

            $("#articlesContainer").append(loading);

            for (var i = articlesCount; i > 0; i--) {
                var loadedArticle = await ajaxForSearch(i, searchQuery.toLowerCase());
                // Move the loading card to after the newly added article card
                $("#searchLoading").insertAfter($("#articlesContainer").children().last());

                if (loadedArticle) {
                    loadedArticles++;
                }
            }
            doingSearch = false;
            // Remove the loading card
            $("#searchLoading").remove();

            if (loadedArticles < 1) {
                var noResults = `<div class="card" id="searchNoResults">
    No results found.
</div>`;

                $("#articlesContainer").empty();
                $("#articlesContainer").append(noResults);
                $("#articlesContainer").prepend(backToArticles);
            }
            else {
                var results = `<div class="card" id="searchResults">
                    Showing ${loadedArticles} of ${loadedArticles} search results for <code>${searchQuery}</code>.
                </div>`;

                // Add the results card to the start of the articles container
                $("#articlesContainer").prepend(results);
                $("#articlesContainer").prepend(backToArticles);
                $("#articlesContainer").append(backToArticles);
            }
        }







        const params = new Proxy(new URLSearchParams(window.location.search), {
            get: (searchParams, prop) => searchParams.get(prop),
        });
        // Get the value of "article" in eg "https://example.com/?article=0"
        let value = params.article; // "0"

        if (value) {


            // Remove the element with class footer, that footer says the page number, which is not needed when not on the articles list
            // $(".footer").remove();



            articleViewAjax(value);


        }
        else {

            // Read all the articles (10 at a time) and add them to the page
            // Erase the contents of the articles container
            $("#articlesContainer").empty();
            $("#articlesContainer").append(articlesListCard);
            doAjaxFor();
        }

        // addArticleFull("0", "Example article", "/alexsour", "https://cdn.glitch.global/d8a67d05-9666-4c27-b92c-98fd552701fd/Spinny%20Alex.gif?v=1646579309555", "Alex_Sour", "March 14, 2022", "https://cdn.glitch.global/d8a67d05-9666-4c27-b92c-98fd552701fd/blog%20creation.png?v=1647295123134", "Example article to test the new blog system", "bla bla bla,<br>haha content<br>eeeee<br>lorem upsum or something?")

        function copyToClipboard(str) {
            const el = document.createElement('textarea');
            el.value = str;
            el.setAttribute('readonly', '');
            el.style.position = 'absolute';
            el.style.left = '-9999px';
            document.body.appendChild(el);
            el.select();
            document.execCommand('copy');
            document.body.removeChild(el);
        };

        function copyPageURL() {
            copyToClipboard(window.location.href.replace('http://', 'https://').replace('https://c', 'https://www.c'));
            // Change the #copied display to inherit
            $("#copiedThing").css("display", "inherit");
        }

        var searchMode = false;

        function search() {
            if (doingSearch) {
                return;
            }
            var searchQuery = $("#searchBar").val().trim();

            // If the search query is empty, do nothing
            if (searchQuery == "") {

                if (searchMode) {
                    $("#articlesContainer").empty();
                    doAjaxFor();
                }

                searchMode = false;
                // Change #headerText's text to "Blog | Home"
                $("#headerText").text("Blog | Home");
                return;
            }

            window.scrollTo(0, 0);

            searchMode = true;
            // Change #headerText's text to "Blog | Search"
            $("#headerText").text("Blog | Search");

            // Clear articles container
            $("#articlesContainer").empty();

            doAjaxForSearch(searchQuery);

        }

        function switchToArticlesList() {

            // Change #headerText's text to "Blog | Home"
            $("#headerText").text("Blog | Home");
            window.history.pushState({}, document.title, "/" + "blog");
            $("#articlesContainer").empty();

            $("#articlesContainer").append(articlesListCard);
            // Change #headerText's text to "Blog | Home"
            window.scrollTo(0, 0);
            $("#headerText").text("Blog | Home");
            doAjaxFor();
            // Change #headerText's text to "Blog | Home"
            $("#headerText").text("Blog | Home");

            // Change page title to Carroted | Blog
            document.title = "Carroted | Blog";
        }
      
      var articleTitle = "something, don't remember what"

        function articleViewAjax(articleID) {
            $.ajax({
                url: '/blog/articles/' + articleID + ".json",
                success: function (data) {
                    var article = data;
                    var writer = getArticleWriter(article.author);

                    // Set site title
                    $("title").text(article.title);
                    articleTitle = article.title;

                    // Erase the contents of the articles container
                    $("#articlesContainer").empty();

                    $("#articlesContainer").append(backToArticles);

                    addArticleFull(articleID, article.title, writer.page, writer.avatar, writer.displayName, dateToString(new Date(article.date * 1000)), article.thumbnail, article.description, article.content);

                    $("#articlesContainer").append(`<div class="card">
                    <h2 style="vertical-align:middle; display: inline-flex; align-items: center;">
                    
                    <svg xmlns="http://www.w3.org/2000/svg" height="34px" viewBox="0 0 24 24" width="34px" fill="#adb6d6"><path d="M0 0h24v24H0V0z" fill="none"/><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81 1.66 0 3-1.34 3-3s-1.34-3-3-3-3 1.34-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9c-1.66 0-3 1.34-3 3s1.34 3 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.16c-.05.21-.08.43-.08.65 0 1.61 1.31 2.92 2.92 2.92s2.92-1.31 2.92-2.92-1.31-2.92-2.92-2.92z"/></svg>

                    &nbspShare this article</h2><br>
                    <button class="button" onclick="copyPageURL()" style="vertical-align:middle; display: inline-flex; align-items: center; padding-left:15px; ">

                    <svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="20px" viewBox="0 0 24 24" width="20px" fill="#FFFFFF"><g><rect fill="none" height="24" width="24"/></g><g><g><path d="M17,7h-3c-0.55,0-1,0.45-1,1s0.45,1,1,1h3c1.65,0,3,1.35,3,3s-1.35,3-3,3h-3c-0.55,0-1,0.45-1,1c0,0.55,0.45,1,1,1h3 c2.76,0,5-2.24,5-5S19.76,7,17,7z M8,12c0,0.55,0.45,1,1,1h6c0.55,0,1-0.45,1-1s-0.45-1-1-1H9C8.45,11,8,11.45,8,12z M10,15H7 c-1.65,0-3-1.35-3-3s1.35-3,3-3h3c0.55,0,1-0.45,1-1s-0.45-1-1-1H7c-2.76,0-5,2.24-5,5s2.24,5,5,5h3c0.55,0,1-0.45,1-1 C11,15.45,10.55,15,10,15z"/></g></g></svg>

                    &nbspCopy Page Link
                    </button>
                    <button class="button" onclick="emailPageURL()" style="vertical-align:middle; display: inline-flex; align-items: center; padding-left:15px; ">

                    <svg xmlns="http://www.w3.org/2000/svg" height="20px" viewBox="0 0 24 24" width="20px" fill="#FFFFFF"><path d="M0 0h24v24H0V0z" fill="none"/><path d="M20 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm-.4 4.25l-7.07 4.42c-.32.2-.74.2-1.06 0L4.4 8.25c-.25-.16-.4-.43-.4-.72 0-.67.73-1.07 1.3-.72L12 11l6.7-4.19c.57-.35 1.3.05 1.3.72 0 .29-.15.56-.4.72z"/></svg>

                    &nbspEmail Page Link
                    </button><br><div id="copiedThing" style="display:none; color:#47a14a">Copied!</div>
                    </div>` + backToArticles);


                    window.scrollTo(0, 0);
                }
            }).catch(error => { window.location.href = "/404.html?type=blog"; });
        }

        function switchToArticle(articleID) {

            window.history.pushState({}, document.title, "/" + "blog" + "?article=" + articleID);

            // Remove the element with class footer, that footer says the page number, which is not needed when not on the articles list
            //   $(".footer").remove();



            articleViewAjax(articleID);

        }
      
      function emailPageURL()
{
  var pageURL = window.location.href.replace('http://', 'https://').replace('https://c', 'https://www.c');
  location.href=`mailto:?to=&subject=Check%20out%20this%20article%20on%20the%20Carroted%20Blog!%20&body=Check%20out%20this%20cool%20article%20named%20%22${articleTitle}%22%20I%20found%20on%20the%20Carroted%20Blog!%0D%0A${pageURL}`;
}

    </script>
    <br><br>

</body>

</html>